CREATE OR REPLACE TRIGGER LOG_PARTY_FAILURE_TRIG
  AFTER INSERT OR UPDATE OF STATUS, FAILURE_MESSAGE
  ON ONBOARDING_PARTY
  FOR EACH ROW
  WHEN (
    lower(NEW.STATUS) like '%fail%'  OR
    NEW.FAILURE_MESSAGE is not null OR
    NEW.FAILURE_MESSAGE != ''
  )
  
BEGIN
    INSERT INTO ONBOARDING_LOG(LOG_ID, ONBOARDING_APPLICATION_ID, CLIENT_GCM_ID, STATUS, FAILURE_MESSAGE, EVENT_TYPE, HAS_BEEN_LOGGED) 
    VALUES (ONBOARDING_LOG_SEQ.NEXTVAL, :NEW.ONBOARDING_APPLICATION_ID, :NEW.GCM_PAN, :NEW.STATUS, :NEW.FAILURE_MESSAGE, 'FAILURE', '0');
END LOG_PARTY_FAILURE_TRIG;
/