<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

	<changeSet id="option_type_ref-create" author="m121103">
		<createTable tableName="OPTION_TYPE_REF">
			<column name="OPTION_TYPE" type="VARCHAR(50)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="DESCRIPTION" type="VARCHAR(255)">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="option-create" author="m121103">
		<createTable tableName="OPTION_REF">
			<column name="OPTION_NAME" type="VARCHAR(50)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="OPTION_TYPE" type="VARCHAR(50)">
				<constraints nullable="false" />
			</column>
			<column name="DESCRIPTION" type="VARCHAR(255)">
				<constraints nullable="false" />
			</column>
			<column name="DEFAULT_VALUE" type="VARCHAR(1023)">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addForeignKeyConstraint 
		    baseColumnNames="OPTION_TYPE" baseTableName="OPTION_REF" 
			constraintName="FK_OPTION_OPTION_TYPE"
			referencedColumnNames="OPTION_TYPE" referencedTableName="OPTION_TYPE_REF" />
	</changeSet>

	<changeSet id="category_type_ref-create" author="m121103">
		<createTable tableName="CATEGORY_TYPE_REF">
			<column name="CATEGORY_TYPE" type="VARCHAR(50)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="DESCRIPTION" type="VARCHAR(255)">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	
	<changeSet id="option_value-create" author="m121103">
		<createTable tableName="OPTION_VALUE">
			<column name="CATEGORY_KEY" type="VARCHAR(50)">
				<constraints nullable="false" />
			</column>
			<column name="CATEGORY_TYPE" type="VARCHAR(50)">
				<constraints nullable="false" />
			</column>		
			<column name="OPTION_NAME" type="VARCHAR(50)">
				<constraints nullable="false" />
			</column>
			<column name="VALUE" type="VARCHAR(50)">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addPrimaryKey columnNames="CATEGORY_KEY, CATEGORY_TYPE, OPTION_NAME"
                       tableName="OPTION_VALUE"/>		
		<addForeignKeyConstraint 
		    baseColumnNames="OPTION_NAME" baseTableName="OPTION_VALUE" 
			constraintName="FK_OPTION_VALUE_OPTION"
			referencedColumnNames="OPTION_NAME" referencedTableName="OPTION_REF" />
		<addForeignKeyConstraint 
		    baseColumnNames="CATEGORY_TYPE" baseTableName="OPTION_VALUE" 
			constraintName="FK_OPTION_VALUE_CATEGORY_TYPE"
			referencedColumnNames="CATEGORY_TYPE" referencedTableName="CATEGORY_TYPE_REF" />			
	</changeSet>
	
	<changeSet author="l061041" id="option-delete-create" runOnChange="true">
	    <delete tableName="OPTION_VALUE">
	    </delete>
	    <delete tableName="OPTION_REF">
	    </delete>
	    <delete tableName="CATEGORY_TYPE_REF">
	    </delete>
	    <delete tableName="OPTION_TYPE_REF">
	    </delete>
	    <loadData encoding="UTF-8"
	    	file="persistence/data/options/option-type-ref.csv"               
	    	separator="," 
	    	tableName="OPTION_TYPE_REF">
	    	<column name="OPTION_TYPE" type="STRING"/>
	    	<column name="DESCRIPTION" type="STRING"/>   		
	    </loadData>
	    <loadData encoding="UTF-8"
	    	file="persistence/data/options/category-type-ref.csv"               
	    	separator="," 
	    	tableName="CATEGORY_TYPE_REF">
	    	<column name="CATEGORY_TYPE" type="STRING"/>   		
	    	<column name="DESCRIPTION" type="STRING"/>                     
	    </loadData>
	    <loadData encoding="UTF-8"
	    	file="persistence/data/options/option-ref.csv"               
	    	separator="," 
	    	tableName="OPTION_REF">
	    	<column name="OPTION_NAME" type="STRING"/>   		
	    	<column name="OPTION_TYPE" type="STRING"/>
	    	<column name="DESCRIPTION" type="STRING"/>   		
	    	<column name="DEFAULT_VALUE" type="STRING"/>
	    </loadData>
	    <loadData encoding="UTF-8"
	    	file="persistence/data/options/idps-overrides.csv"               
	    	separator="," 
	    	tableName="OPTION_VALUE">
	    	<column name="CATEGORY_KEY" type="STRING"/>   		
	    	<column name="CATEGORY_TYPE" type="STRING"/>
	    	<column name="OPTION_NAME" type="STRING"/>   		
	    	<column name="VALUE" type="STRING"/>
	    </loadData>
	    <loadData encoding="UTF-8"
	    	file="persistence/data/options/sup-overrides.csv"               
	    	separator="," 
	    	tableName="OPTION_VALUE">
	    	<column name="CATEGORY_KEY" type="STRING"/>   		
	    	<column name="CATEGORY_TYPE" type="STRING"/>
	    	<column name="OPTION_NAME" type="STRING"/>   		
	    	<column name="VALUE" type="STRING"/>
	    </loadData>
	     <loadData encoding="UTF-8"
	    	file="persistence/data/options/accumulation-overrides.csv"               
	    	separator="," 
	    	tableName="OPTION_VALUE">
	    	<column name="CATEGORY_KEY" type="STRING"/>   		
	    	<column name="CATEGORY_TYPE" type="STRING"/>
	    	<column name="OPTION_NAME" type="STRING"/>   		
	    	<column name="VALUE" type="STRING"/>
	   </loadData>
	   <loadData encoding="UTF-8"
	        file="persistence/data/options/non-idps-overrides.csv"
	        separator="," 
	        tableName="OPTION_VALUE">
	        <column name="CATEGORY_KEY" type="STRING"/>   		
	        <column name="CATEGORY_TYPE" type="STRING"/>
	        <column name="OPTION_NAME" type="STRING"/>   		
	        <column name="VALUE" type="STRING"/>
	   </loadData>
		<loadData encoding="UTF-8"
				  file="persistence/data/options/annuity-overrides.csv"
				  separator=","
				  tableName="OPTION_VALUE">
			<column name="CATEGORY_KEY" type="STRING"/>
			<column name="CATEGORY_TYPE" type="STRING"/>
			<column name="OPTION_NAME" type="STRING"/>
			<column name="VALUE" type="STRING"/>
		</loadData>
	</changeSet>
</databaseChangeLog>